{"ast":null,"code":"import React,{useEffect}from'react';import FeedStats from'../components/feed-stats/feed-stats';import OrderCard from'../components/order-card/order-card';import styles from'./feed-page.module.css';import{useAppDispatch,useAppSelector}from'../store/hooks';import{wsFeedStart,wsFeedClosed}from'../store/slices/order-feed-slice';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const FeedPage=()=>{const dispatch=useAppDispatch();const{orders}=useAppSelector(state=>state.orderFeed);const ingredients=useAppSelector(state=>state.ingredients.items);useEffect(()=>{dispatch(wsFeedStart());return()=>{dispatch(wsFeedClosed());};},[dispatch]);const getOrderPrice=orderIngredients=>{return orderIngredients.reduce((sum,id)=>{const ingredient=ingredients.find(i=>i._id===id);return ingredient?sum+ingredient.price:sum;},0);};const getOrderIngredients=orderIngredients=>{return orderIngredients.map(id=>ingredients.find(i=>i._id===id)).filter(i=>Boolean(i));};// Для теста: подменяем статус первого заказа на 'pending', если есть хотя бы один заказ\nconst testOrders=orders.length>0?[{...orders[0],status:'pending'},...orders.slice(1)]:orders;return/*#__PURE__*/_jsxs(\"div\",{className:styles.feedWrapper,children:[/*#__PURE__*/_jsxs(\"div\",{className:styles.feedList,children:[/*#__PURE__*/_jsx(\"h1\",{className:styles.title,children:\"\\u041B\\u0435\\u043D\\u0442\\u0430 \\u0437\\u0430\\u043A\\u0430\\u0437\\u043E\\u0432\"}),/*#__PURE__*/_jsx(\"div\",{className:styles.orders,children:testOrders.map(order=>/*#__PURE__*/_jsx(OrderCard,{order:{number:order.number,name:`Заказ #${order.number}`,date:new Date(order.createdAt).toLocaleString('ru-RU',{hour:'2-digit',minute:'2-digit',day:'numeric',month:'long'}),ingredients:getOrderIngredients(order.ingredients),price:getOrderPrice(order.ingredients),status:order.status}},order._id))})]}),/*#__PURE__*/_jsx(FeedStats,{})]});};export default FeedPage;","map":{"version":3,"names":["React","useEffect","FeedStats","OrderCard","styles","useAppDispatch","useAppSelector","wsFeedStart","wsFeedClosed","jsx","_jsx","jsxs","_jsxs","FeedPage","dispatch","orders","state","orderFeed","ingredients","items","getOrderPrice","orderIngredients","reduce","sum","id","ingredient","find","i","_id","price","getOrderIngredients","map","filter","Boolean","testOrders","length","status","slice","className","feedWrapper","children","feedList","title","order","number","name","date","Date","createdAt","toLocaleString","hour","minute","day","month"],"sources":["/Users/antonkaliberov/Desktop/Обучение реакт/Спринт 1 /react-burger/src/pages/feed-page.tsx"],"sourcesContent":["import React, { useEffect } from 'react';\nimport FeedStats from '../components/feed-stats/feed-stats';\nimport OrderCard from '../components/order-card/order-card';\nimport styles from './feed-page.module.css';\nimport { useAppDispatch, useAppSelector } from '../store/hooks';\nimport { wsFeedStart, wsFeedClosed } from '../store/slices/order-feed-slice';\nimport { RootState } from '../store/types';\n\nconst FeedPage: React.FC = () => {\n  const dispatch = useAppDispatch();\n  const { orders } = useAppSelector((state: RootState) => state.orderFeed);\n  const ingredients = useAppSelector((state: RootState) => state.ingredients.items);\n\n  useEffect(() => {\n    dispatch(wsFeedStart());\n    return () => {\n      dispatch(wsFeedClosed());\n    };\n  }, [dispatch]);\n  \n  const getOrderPrice = (orderIngredients: string[]) => {\n    return orderIngredients.reduce((sum, id) => {\n      const ingredient = ingredients.find(i => i._id === id);\n      return ingredient ? sum + ingredient.price : sum;\n    }, 0);\n  };\n\n  const getOrderIngredients = (orderIngredients: string[]) => {\n    return orderIngredients\n      .map(id => ingredients.find(i => i._id === id))\n      .filter((i): i is typeof ingredients[number] => Boolean(i));\n  };\n\n  // Для теста: подменяем статус первого заказа на 'pending', если есть хотя бы один заказ\n  const testOrders = orders.length > 0 ? [\n    { ...orders[0], status: 'pending' },\n    ...orders.slice(1)\n  ] : orders;\n\n  return (\n    <div className={styles.feedWrapper}>\n      <div className={styles.feedList}>\n        <h1 className={styles.title}>Лента заказов</h1>\n        <div className={styles.orders}>\n          {testOrders.map(order => (\n            <OrderCard\n              key={order._id}\n              order={{\n                number: order.number,\n                name: `Заказ #${order.number}`,\n                date: new Date(order.createdAt).toLocaleString('ru-RU', { hour: '2-digit', minute: '2-digit', day: 'numeric', month: 'long' }),\n                ingredients: getOrderIngredients(order.ingredients),\n                price: getOrderPrice(order.ingredients),\n                status: order.status\n              }}\n            />\n          ))}\n        </div>\n      </div>\n      <FeedStats />\n    </div>\n  );\n};\n\nexport default FeedPage; "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}