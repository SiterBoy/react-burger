{"ast":null,"code":"import React,{useRef,useEffect}from'react';import{useNavigate,useLocation}from'react-router-dom';import styles from'./burger-ingredients.module.css';import{Tab}from'@ya.praktikum/react-developer-burger-ui-components';import BurgerIngredientsListItem from'../burger-ingredients-list-item/burger-ingredients-list-item';import{useAppDispatch,useAppSelector}from'../../store/hooks';import{setCurrentTab}from'../../store/slices/tabs-slice';import{addIngredient}from'../../store/slices/constructor-slice';import{incrementCounter}from'../../store/slices/ingredients-slice';import{setIngredientDetails}from'../../store/slices/ingredient-details-slice';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const BurgerIngredients=()=>{const dispatch=useAppDispatch();const navigate=useNavigate();const location=useLocation();const currentTab=useAppSelector(state=>state.tabs.currentTab);const ingredients=useAppSelector(state=>state.ingredients.items);const containerRef=useRef(null);const buns=ingredients.filter(el=>el.type==='bun');const sauces=ingredients.filter(el=>el.type==='sauce');const fillings=ingredients.filter(el=>el.type==='main');useEffect(()=>{const options={root:null,threshold:0,rootMargin:'-100px 0px 0px 0px'};const observer=new IntersectionObserver(entries=>{entries.forEach(entry=>{if(entry.isIntersecting){const type=entry.target.getAttribute('data-type');if(type==='bun'||type==='sauce'||type==='main'){dispatch(setCurrentTab(type));}}});},options);const headers=document.querySelectorAll('[data-type]');headers.forEach(header=>observer.observe(header));return()=>{headers.forEach(header=>observer.unobserve(header));};},[dispatch]);const handleTabClick=type=>{dispatch(setCurrentTab(type));const element=document.querySelector(`[data-type=\"${type}\"]`);if(element){element.scrollIntoView({behavior:'smooth'});}};const handleIngredientClick=ingredient=>{dispatch(setIngredientDetails(ingredient));navigate(`/ingredients/${ingredient._id}`,{state:{background:location}});};const handleIngredientDrop=ingredient=>{dispatch(addIngredient(ingredient));dispatch(incrementCounter(ingredient._id));};const renderCategory=type=>{const categoryMap={bun:{items:buns,title:'Булки'},sauce:{items:sauces,title:'Соусы'},main:{items:fillings,title:'Начинки'}};const category=categoryMap[type];if(category.items.length===0)return null;return/*#__PURE__*/_jsxs(\"div\",{className:styles.burgerIngredientsCategory,children:[/*#__PURE__*/_jsx(\"h2\",{\"data-type\":type,className:styles.burgerIngredientsCategoryTitle,children:category.title}),/*#__PURE__*/_jsx(\"ul\",{className:styles.burgerIngredientsItems,\"data-testid\":`ingredients-${type}`,children:category.items.map(item=>/*#__PURE__*/_jsx(BurgerIngredientsListItem,{onClick:()=>handleIngredientClick(item),onDrop:()=>handleIngredientDrop(item),ingridient:item},item._id))})]});};return/*#__PURE__*/_jsxs(\"section\",{className:styles.burgerIngredientsContainer,children:[/*#__PURE__*/_jsx(\"h1\",{className:styles.burgerIngredientsTitle,children:\"\\u0421\\u043E\\u0431\\u0435\\u0440\\u0438\\u0442\\u0435 \\u0431\\u0443\\u0440\\u0433\\u0435\\u0440\"}),/*#__PURE__*/_jsxs(\"div\",{className:styles.burgerIngredientsTabs,children:[buns.length>0&&/*#__PURE__*/_jsx(Tab,{value:\"bun\",active:currentTab==='bun',onClick:()=>handleTabClick('bun'),children:\"\\u0411\\u0443\\u043B\\u043A\\u0438\"}),sauces.length>0&&/*#__PURE__*/_jsx(Tab,{value:\"sauce\",active:currentTab==='sauce',onClick:()=>handleTabClick('sauce'),children:\"\\u0421\\u043E\\u0443\\u0441\\u044B\"}),fillings.length>0&&/*#__PURE__*/_jsx(Tab,{value:\"main\",active:currentTab==='main',onClick:()=>handleTabClick('main'),children:\"\\u041D\\u0430\\u0447\\u0438\\u043D\\u043A\\u0438\"})]}),/*#__PURE__*/_jsxs(\"div\",{ref:containerRef,className:styles.burgerIngredientsList,children:[renderCategory('bun'),renderCategory('sauce'),renderCategory('main')]})]});};export default BurgerIngredients;","map":{"version":3,"names":["React","useRef","useEffect","useNavigate","useLocation","styles","Tab","BurgerIngredientsListItem","useAppDispatch","useAppSelector","setCurrentTab","addIngredient","incrementCounter","setIngredientDetails","jsx","_jsx","jsxs","_jsxs","BurgerIngredients","dispatch","navigate","location","currentTab","state","tabs","ingredients","items","containerRef","buns","filter","el","type","sauces","fillings","options","root","threshold","rootMargin","observer","IntersectionObserver","entries","forEach","entry","isIntersecting","target","getAttribute","headers","document","querySelectorAll","header","observe","unobserve","handleTabClick","element","querySelector","scrollIntoView","behavior","handleIngredientClick","ingredient","_id","background","handleIngredientDrop","renderCategory","categoryMap","bun","title","sauce","main","category","length","className","burgerIngredientsCategory","children","burgerIngredientsCategoryTitle","burgerIngredientsItems","map","item","onClick","onDrop","ingridient","burgerIngredientsContainer","burgerIngredientsTitle","burgerIngredientsTabs","value","active","ref","burgerIngredientsList"],"sources":["/Users/antonkaliberov/Desktop/Обучение реакт/Спринт 1 /react-burger/src/components/burger-ingredients/burger-ingredients.tsx"],"sourcesContent":["import React, { useRef, useEffect } from 'react';\nimport { useNavigate, useLocation } from 'react-router-dom';\nimport styles from './burger-ingredients.module.css';\nimport { Tab } from '@ya.praktikum/react-developer-burger-ui-components';\nimport IIngredientData from '../../types/interfaces/ingridient-data.interface';\nimport BurgerIngredientsListItem from '../burger-ingredients-list-item/burger-ingredients-list-item';\nimport { useAppDispatch, useAppSelector } from '../../store/hooks';\nimport { setCurrentTab } from '../../store/slices/tabs-slice';\nimport { addIngredient } from '../../store/slices/constructor-slice';\nimport { incrementCounter } from '../../store/slices/ingredients-slice';\nimport { setIngredientDetails } from '../../store/slices/ingredient-details-slice';\nimport { RootState } from '../../store/types';\n\nconst BurgerIngredients: React.FC = () => {\n  const dispatch = useAppDispatch();\n  const navigate = useNavigate();\n  const location = useLocation();\n  const currentTab = useAppSelector(\n    (state: RootState) => state.tabs.currentTab\n  );\n  const ingredients = useAppSelector(\n    (state: RootState) => state.ingredients.items\n  );\n  const containerRef = useRef<HTMLDivElement>(null);\n\n  const buns = ingredients.filter((el: IIngredientData) => el.type === 'bun');\n  const sauces = ingredients.filter(\n    (el: IIngredientData) => el.type === 'sauce'\n  );\n  const fillings = ingredients.filter(\n    (el: IIngredientData) => el.type === 'main'\n  );\n\n  useEffect(() => {\n    const options: IntersectionObserverInit = {\n      root: null,\n      threshold: 0,\n      rootMargin: '-100px 0px 0px 0px',\n    };\n\n    const observer = new IntersectionObserver(\n      (entries: IntersectionObserverEntry[]) => {\n        entries.forEach(entry => {\n          if (entry.isIntersecting) {\n            const type = entry.target.getAttribute('data-type');\n            if (type === 'bun' || type === 'sauce' || type === 'main') {\n              dispatch(setCurrentTab(type));\n            }\n          }\n        });\n      },\n      options\n    );\n\n    const headers = document.querySelectorAll('[data-type]');\n    headers.forEach(header => observer.observe(header));\n\n    return () => {\n      headers.forEach(header => observer.unobserve(header));\n    };\n  }, [dispatch]);\n\n  const handleTabClick = (type: 'bun' | 'sauce' | 'main'): void => {\n    dispatch(setCurrentTab(type));\n    const element = document.querySelector(`[data-type=\"${type}\"]`);\n    if (element) {\n      element.scrollIntoView({ behavior: 'smooth' });\n    }\n  };\n\n  const handleIngredientClick = (ingredient: IIngredientData): void => {\n    dispatch(setIngredientDetails(ingredient));\n    navigate(`/ingredients/${ingredient._id}`, {\n      state: { background: location },\n    });\n  };\n\n  const handleIngredientDrop = (ingredient: IIngredientData): void => {\n    dispatch(addIngredient(ingredient));\n    dispatch(incrementCounter(ingredient._id));\n  };\n\n  const renderCategory = (type: 'bun' | 'sauce' | 'main') => {\n    const categoryMap = {\n      bun: { items: buns, title: 'Булки' },\n      sauce: { items: sauces, title: 'Соусы' },\n      main: { items: fillings, title: 'Начинки' },\n    };\n\n    const category = categoryMap[type];\n    if (category.items.length === 0) return null;\n\n    return (\n      <div className={styles.burgerIngredientsCategory}>\n        <h2 data-type={type} className={styles.burgerIngredientsCategoryTitle}>\n          {category.title}\n        </h2>\n        <ul\n          className={styles.burgerIngredientsItems}\n          data-testid={`ingredients-${type}`}\n        >\n          {category.items.map((item: IIngredientData) => (\n            <BurgerIngredientsListItem\n              key={item._id}\n              onClick={() => handleIngredientClick(item)}\n              onDrop={() => handleIngredientDrop(item)}\n              ingridient={item}\n            />\n          ))}\n        </ul>\n      </div>\n    );\n  };\n\n  return (\n    <section className={styles.burgerIngredientsContainer}>\n      <h1 className={styles.burgerIngredientsTitle}>Соберите бургер</h1>\n\n      <div className={styles.burgerIngredientsTabs}>\n        {buns.length > 0 && (\n          <Tab\n            value='bun'\n            active={currentTab === 'bun'}\n            onClick={() => handleTabClick('bun')}\n          >\n            Булки\n          </Tab>\n        )}\n        {sauces.length > 0 && (\n          <Tab\n            value='sauce'\n            active={currentTab === 'sauce'}\n            onClick={() => handleTabClick('sauce')}\n          >\n            Соусы\n          </Tab>\n        )}\n        {fillings.length > 0 && (\n          <Tab\n            value='main'\n            active={currentTab === 'main'}\n            onClick={() => handleTabClick('main')}\n          >\n            Начинки\n          </Tab>\n        )}\n      </div>\n\n      <div ref={containerRef} className={styles.burgerIngredientsList}>\n        {renderCategory('bun')}\n        {renderCategory('sauce')}\n        {renderCategory('main')}\n      </div>\n    </section>\n  );\n};\n\nexport default BurgerIngredients;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}