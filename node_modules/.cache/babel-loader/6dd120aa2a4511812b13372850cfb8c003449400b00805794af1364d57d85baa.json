{"ast":null,"code":"import React,{useRef}from'react';import{ConstructorElement,DragIcon}from'@ya.praktikum/react-developer-burger-ui-components';import styles from'./burger-constructor-list-item.module.css';import{useDrag,useDrop}from'react-dnd';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const map={top:' (верх)',bottom:' (низ)'};const BurgerConstructorListItem=_ref=>{let{ingridient,type,isLocked,index,onRemove,moveCard}=_ref;const{name,price,image}=ingridient;const finalText=type?name+map[type]:name;const ref=useRef(null);const[{handlerId},drop]=useDrop({accept:'ingredient',collect(monitor){return{handlerId:monitor.getHandlerId()};},hover(item,monitor){var _ref$current;if(!ref.current){return;}const dragIndex=item.index;const hoverIndex=index;if(dragIndex===hoverIndex){return;}const hoverBoundingRect=(_ref$current=ref.current)===null||_ref$current===void 0?void 0:_ref$current.getBoundingClientRect();const hoverMiddleY=(hoverBoundingRect.bottom-hoverBoundingRect.top)/2;const clientOffset=monitor.getClientOffset();const hoverClientY=clientOffset.y-hoverBoundingRect.top;if(dragIndex<hoverIndex&&hoverClientY<hoverMiddleY){return;}if(dragIndex>hoverIndex&&hoverClientY>hoverMiddleY){return;}moveCard(dragIndex,hoverIndex);item.index=hoverIndex;}});const[{isDragging},drag]=useDrag({type:'ingredient',item:()=>{return{index};},collect:monitor=>({isDragging:monitor.isDragging()})});const opacity=isDragging?0.4:1;drag(drop(ref));return/*#__PURE__*/_jsxs(\"li\",{ref:ref,className:styles.burgerConstructorIngridient,style:{opacity},\"data-handler-id\":handlerId,children:[/*#__PURE__*/_jsx(\"button\",{className:styles.burgerConstructorMoveButton,\"aria-label\":\"Open task menu\",\"aria-haspopup\":\"true\",children:/*#__PURE__*/_jsx(DragIcon,{type:\"primary\",className:styles.burgerConstructorDragIcon})}),/*#__PURE__*/_jsx(ConstructorElement,{text:finalText,price:price,thumbnail:image,isLocked:isLocked,type:type,handleClose:()=>onRemove(ingridient.uuid)}),/*#__PURE__*/_jsx(\"div\",{className:styles.scrollAreaGap})]});};export default BurgerConstructorListItem;","map":{"version":3,"names":["React","useRef","ConstructorElement","DragIcon","styles","useDrag","useDrop","jsx","_jsx","jsxs","_jsxs","map","top","bottom","BurgerConstructorListItem","_ref","ingridient","type","isLocked","index","onRemove","moveCard","name","price","image","finalText","ref","handlerId","drop","accept","collect","monitor","getHandlerId","hover","item","_ref$current","current","dragIndex","hoverIndex","hoverBoundingRect","getBoundingClientRect","hoverMiddleY","clientOffset","getClientOffset","hoverClientY","y","isDragging","drag","opacity","className","burgerConstructorIngridient","style","children","burgerConstructorMoveButton","burgerConstructorDragIcon","text","thumbnail","handleClose","uuid","scrollAreaGap"],"sources":["/Users/antonkaliberov/Desktop/Обучение реакт/Спринт 1 /react-burger/src/components/burger-constructor-list-item/burger-constructor-list-item.tsx"],"sourcesContent":["import React, { useRef } from 'react';\nimport {\n  ConstructorElement,\n  DragIcon,\n} from '@ya.praktikum/react-developer-burger-ui-components';\nimport IIngredientData from '../../types/interfaces/ingridient-data.interface';\nimport styles from './burger-constructor-list-item.module.css';\nimport { useDrag, useDrop } from 'react-dnd';\n\ntype Ttype = 'top' | 'bottom';\n\nconst map: Record<Ttype, string> = {\n  top: ' (верх)',\n  bottom: ' (низ)',\n};\n\ninterface DragItem {\n  index: number;\n  type: string;\n}\n\ninterface IConstructorIngredient extends IIngredientData {\n  uuid: string;\n}\n\ninterface IBurgerConstructorListItemProps {\n  ingridient: IConstructorIngredient;\n  type?: 'top' | 'bottom';\n  isLocked?: boolean;\n  index: number;\n  onRemove: (uuid: string) => void;\n  moveCard: (dragIndex: number, hoverIndex: number) => void;\n}\n\nconst BurgerConstructorListItem: React.FC<IBurgerConstructorListItemProps> = ({\n  ingridient,\n  type,\n  isLocked,\n  index,\n  onRemove,\n  moveCard,\n}) => {\n  const { name, price, image } = ingridient;\n  const finalText = type ? name + map[type] : name;\n  const ref = useRef<HTMLLIElement>(null);\n\n  const [{ handlerId }, drop] = useDrop<\n    DragItem,\n    void,\n    { handlerId: string | symbol | null }\n  >({\n    accept: 'ingredient',\n    collect(monitor) {\n      return {\n        handlerId: monitor.getHandlerId(),\n      };\n    },\n    hover(item: { index: number }, monitor) {\n      if (!ref.current) {\n        return;\n      }\n      const dragIndex = item.index;\n      const hoverIndex = index;\n\n      if (dragIndex === hoverIndex) {\n        return;\n      }\n\n      const hoverBoundingRect = ref.current?.getBoundingClientRect();\n      const hoverMiddleY =\n        (hoverBoundingRect.bottom - hoverBoundingRect.top) / 2;\n      const clientOffset = monitor.getClientOffset();\n      const hoverClientY = clientOffset!.y - hoverBoundingRect.top;\n\n      if (dragIndex < hoverIndex && hoverClientY < hoverMiddleY) {\n        return;\n      }\n      if (dragIndex > hoverIndex && hoverClientY > hoverMiddleY) {\n        return;\n      }\n\n      moveCard(dragIndex, hoverIndex);\n      item.index = hoverIndex;\n    },\n  });\n\n  const [{ isDragging }, drag] = useDrag({\n    type: 'ingredient',\n    item: () => {\n      return { index };\n    },\n    collect: monitor => ({\n      isDragging: monitor.isDragging(),\n    }),\n  });\n\n  const opacity = isDragging ? 0.4 : 1;\n  drag(drop(ref));\n\n  return (\n    <li\n      ref={ref}\n      className={styles.burgerConstructorIngridient}\n      style={{ opacity }}\n      data-handler-id={handlerId}\n    >\n      <button\n        className={styles.burgerConstructorMoveButton}\n        aria-label='Open task menu'\n        aria-haspopup='true'\n      >\n        <DragIcon type='primary' className={styles.burgerConstructorDragIcon} />\n      </button>\n      <ConstructorElement\n        text={finalText}\n        price={price}\n        thumbnail={image}\n        isLocked={isLocked}\n        type={type}\n        handleClose={() => onRemove(ingridient.uuid)}\n      />\n      <div className={styles.scrollAreaGap}></div>\n    </li>\n  );\n};\n\nexport default BurgerConstructorListItem;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}