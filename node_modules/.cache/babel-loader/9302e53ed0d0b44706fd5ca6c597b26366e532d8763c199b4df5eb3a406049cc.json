{"ast":null,"code":"import React from'react';import{useParams,useLocation}from'react-router-dom';import{useAppSelector}from'../store/hooks';import styles from'./order-details-page.module.css';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const OrderDetailsPage=()=>{const{number}=useParams();const location=useLocation();const isProfile=location.pathname.startsWith('/profile/orders');const orders=useAppSelector(state=>{var _state$profileOrders,_state$orderFeed;return isProfile?((_state$profileOrders=state.profileOrders)===null||_state$profileOrders===void 0?void 0:_state$profileOrders.orders)||[]:((_state$orderFeed=state.orderFeed)===null||_state$orderFeed===void 0?void 0:_state$orderFeed.orders)||[];});const ingredients=useAppSelector(state=>state.ingredients.items);const order=orders.find(o=>String(o.number)===number);if(!order){return/*#__PURE__*/_jsx(\"div\",{className:styles.detailsWrapper,children:\"\\u0417\\u0430\\u043A\\u0430\\u0437 \\u043D\\u0435 \\u043D\\u0430\\u0439\\u0434\\u0435\\u043D\"});}const ingredientMap=order.ingredients.reduce((acc,id)=>{acc[id]=(acc[id]||0)+1;return acc;},{});const orderIngredients=Object.entries(ingredientMap).map(_ref=>{let[id,count]=_ref;const ingredient=ingredients.find(i=>i._id===id);return ingredient?{...ingredient,count}:null;}).filter(item=>item!==null);const totalPrice=orderIngredients.reduce((sum,ing)=>sum+ing.price*ing.count,0);return/*#__PURE__*/_jsxs(\"div\",{className:styles.detailsWrapper,children:[/*#__PURE__*/_jsxs(\"div\",{className:styles.number,children:[\"#\",order.number]}),/*#__PURE__*/_jsx(\"h2\",{className:styles.name,children:order.name}),/*#__PURE__*/_jsx(\"div\",{className:styles.status,children:order.status}),/*#__PURE__*/_jsx(\"div\",{className:styles.sectionTitle,children:\"\\u0421\\u043E\\u0441\\u0442\\u0430\\u0432:\"}),/*#__PURE__*/_jsx(\"ul\",{className:styles.ingredients,children:orderIngredients.map((item,idx)=>/*#__PURE__*/_jsxs(\"li\",{className:styles.ingredientRow,children:[/*#__PURE__*/_jsx(\"div\",{className:styles.ingredientName,children:item.name}),/*#__PURE__*/_jsxs(\"div\",{className:styles.ingredientCount,children:[item.count,\" x \",item.price]})]},idx))}),/*#__PURE__*/_jsxs(\"div\",{className:styles.footer,children:[/*#__PURE__*/_jsx(\"span\",{className:styles.date,children:new Date(order.createdAt).toLocaleString('ru-RU',{hour:'2-digit',minute:'2-digit',day:'numeric',month:'long'})}),/*#__PURE__*/_jsx(\"span\",{className:styles.price,children:totalPrice})]})]});};export default OrderDetailsPage;","map":{"version":3,"names":["React","useParams","useLocation","useAppSelector","styles","jsx","_jsx","jsxs","_jsxs","OrderDetailsPage","number","location","isProfile","pathname","startsWith","orders","state","_state$profileOrders","_state$orderFeed","profileOrders","orderFeed","ingredients","items","order","find","o","String","className","detailsWrapper","children","ingredientMap","reduce","acc","id","orderIngredients","Object","entries","map","_ref","count","ingredient","i","_id","filter","item","totalPrice","sum","ing","price","name","status","sectionTitle","idx","ingredientRow","ingredientName","ingredientCount","footer","date","Date","createdAt","toLocaleString","hour","minute","day","month"],"sources":["/Users/antonkaliberov/Desktop/Обучение реакт/Спринт 1 /react-burger/src/pages/order-details-page.tsx"],"sourcesContent":["import React from 'react';\nimport { useParams, useLocation } from 'react-router-dom';\nimport { useAppSelector } from '../store/hooks';\nimport type { Order } from '../store/slices/order-feed-slice';\nimport type IIngredientData from '../types/interfaces/ingridient-data.interface';\nimport styles from './order-details-page.module.css';\n\ninterface OrderIngredient extends IIngredientData {\n  count: number;\n}\n\nconst OrderDetailsPage: React.FC = () => {\n  const { number } = useParams<{ number: string }>();\n  const location = useLocation();\n  const isProfile = location.pathname.startsWith('/profile/orders');\n  const orders = useAppSelector(state =>\n    isProfile ? state.profileOrders?.orders || [] : state.orderFeed?.orders || []\n  );\n  const ingredients = useAppSelector(state => state.ingredients.items);\n\n  const order = orders.find((o: Order) => String(o.number) === number);\n\n  if (!order) {\n    return <div className={styles.detailsWrapper}>Заказ не найден</div>;\n  }\n\n  const ingredientMap = order.ingredients.reduce((acc: Record<string, number>, id: string) => {\n    acc[id] = (acc[id] || 0) + 1;\n    return acc;\n  }, {});\n  const orderIngredients: OrderIngredient[] = Object.entries(ingredientMap).map(([id, count]) => {\n    const ingredient = ingredients.find(i => i._id === id);\n    return ingredient ? { ...ingredient, count } : null;\n  }).filter((item): item is OrderIngredient => item !== null);\n\n  const totalPrice = orderIngredients.reduce((sum, ing) => sum + (ing.price * ing.count), 0);\n\n  return (\n    <div className={styles.detailsWrapper}>\n      <div className={styles.number}>#{order.number}</div>\n      <h2 className={styles.name}>{order.name}</h2>\n      <div className={styles.status}>{order.status}</div>\n      <div className={styles.sectionTitle}>Состав:</div>\n      <ul className={styles.ingredients}>\n        {orderIngredients.map((item, idx) => (\n          <li key={idx} className={styles.ingredientRow}>\n            <div className={styles.ingredientName}>{item.name}</div>\n            <div className={styles.ingredientCount}>{item.count} x {item.price}</div>\n          </li>\n        ))}\n      </ul>\n      <div className={styles.footer}>\n        <span className={styles.date}>{new Date(order.createdAt).toLocaleString('ru-RU', { hour: '2-digit', minute: '2-digit', day: 'numeric', month: 'long' })}</span>\n        <span className={styles.price}>{totalPrice}</span>\n      </div>\n    </div>\n  );\n};\n\nexport default OrderDetailsPage; "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}