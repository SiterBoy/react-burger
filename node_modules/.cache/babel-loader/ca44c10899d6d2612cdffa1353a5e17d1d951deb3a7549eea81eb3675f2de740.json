{"ast":null,"code":"import React,{useRef}from'react';import{useNavigate,useLocation}from'react-router-dom';import{useDrag}from'react-dnd';import styles from'../burger-ingredients/burger-ingredients.module.css';import{Counter,CurrencyIcon}from'@ya.praktikum/react-developer-burger-ui-components';import{useAppSelector}from'../../store/hooks';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const BurgerIngredientsListItem=_ref=>{let{ingridient,onClick,onDrop}=_ref;const{_id,image,name,price}=ingridient;const count=useAppSelector(state=>state.ingredients.counters[_id]||0);const navigate=useNavigate();const location=useLocation();const ref=useRef(null);const[{isDragging},dragRef]=useDrag({type:'ingredient',item:()=>ingridient,end:(item,monitor)=>{const dropResult=monitor.getDropResult();if(item&&dropResult){onDrop();}},collect:monitor=>({isDragging:monitor.isDragging()})});const handleClick=()=>{navigate(`/ingredients/${_id}`,{state:{background:location}});};const opacity=isDragging?0.4:1;// Подключаем drag ref к элементу\ndragRef(ref);return/*#__PURE__*/_jsxs(\"li\",{ref:ref,className:styles.ingredient,onClick:handleClick,style:{opacity},\"data-testid\":\"ingredient-card\",children:[/*#__PURE__*/_jsx(\"img\",{src:image,alt:name,className:styles.ingredientImage}),count>0&&/*#__PURE__*/_jsx(Counter,{count:count,size:\"default\",extraClass:\"m-1\"}),/*#__PURE__*/_jsxs(\"div\",{className:styles.ingredientPriceBlock,children:[/*#__PURE__*/_jsx(\"span\",{className:styles.ingredientPrice,children:price}),/*#__PURE__*/_jsx(CurrencyIcon,{type:\"primary\"})]}),/*#__PURE__*/_jsx(\"p\",{className:styles.ingredientName,children:name})]},_id);};export default BurgerIngredientsListItem;","map":{"version":3,"names":["React","useRef","useNavigate","useLocation","useDrag","styles","Counter","CurrencyIcon","useAppSelector","jsx","_jsx","jsxs","_jsxs","BurgerIngredientsListItem","_ref","ingridient","onClick","onDrop","_id","image","name","price","count","state","ingredients","counters","navigate","location","ref","isDragging","dragRef","type","item","end","monitor","dropResult","getDropResult","collect","handleClick","background","opacity","className","ingredient","style","children","src","alt","ingredientImage","size","extraClass","ingredientPriceBlock","ingredientPrice","ingredientName"],"sources":["/Users/antonkaliberov/Desktop/Обучение реакт/Спринт 1 /react-burger/src/components/burger-ingredients-list-item/burger-ingredients-list-item.tsx"],"sourcesContent":["import React, { useRef } from 'react';\nimport { useNavigate, useLocation } from 'react-router-dom';\nimport { useDrag } from 'react-dnd';\nimport IIngredientData from '../../types/interfaces/ingridient-data.interface';\nimport styles from '../burger-ingredients/burger-ingredients.module.css';\nimport {\n  Counter,\n  CurrencyIcon,\n} from '@ya.praktikum/react-developer-burger-ui-components';\nimport { useAppSelector } from '../../store/hooks';\nimport { RootState } from '../../store/types';\n\nconst BurgerIngredientsListItem: React.FC<IBurgerIngredientsListItemProps> = ({\n  ingridient,\n  onClick,\n  onDrop,\n}) => {\n  const { _id, image, name, price } = ingridient;\n  const count = useAppSelector(\n    (state: RootState) => state.ingredients.counters[_id] || 0\n  );\n  const navigate = useNavigate();\n  const location = useLocation();\n  const ref = useRef<HTMLLIElement>(null);\n\n  const [{ isDragging }, dragRef] = useDrag({\n    type: 'ingredient',\n    item: () => ingridient,\n    end: (item, monitor) => {\n      const dropResult = monitor.getDropResult();\n      if (item && dropResult) {\n        onDrop();\n      }\n    },\n    collect: monitor => ({\n      isDragging: monitor.isDragging(),\n    }),\n  });\n\n  const handleClick = () => {\n    navigate(`/ingredients/${_id}`, { state: { background: location } });\n  };\n\n  const opacity = isDragging ? 0.4 : 1;\n\n  // Подключаем drag ref к элементу\n  dragRef(ref);\n\n  return (\n    <li\n      ref={ref}\n      key={_id}\n      className={styles.ingredient}\n      onClick={handleClick}\n      style={{ opacity }}\n      data-testid='ingredient-card'\n    >\n      <img src={image} alt={name} className={styles.ingredientImage} />\n      {count > 0 && <Counter count={count} size='default' extraClass='m-1' />}\n      <div className={styles.ingredientPriceBlock}>\n        <span className={styles.ingredientPrice}>{price}</span>\n        <CurrencyIcon type='primary' />\n      </div>\n      <p className={styles.ingredientName}>{name}</p>\n    </li>\n  );\n};\n\ninterface IBurgerIngredientsListItemProps {\n  ingridient: IIngredientData;\n  onClick: () => void;\n  onDrop: () => void;\n}\n\nexport default BurgerIngredientsListItem;\n"],"mappings":"AAAA,MAAO,CAAAA,KAAK,EAAIC,MAAM,KAAQ,OAAO,CACrC,OAASC,WAAW,CAAEC,WAAW,KAAQ,kBAAkB,CAC3D,OAASC,OAAO,KAAQ,WAAW,CAEnC,MAAO,CAAAC,MAAM,KAAM,qDAAqD,CACxE,OACEC,OAAO,CACPC,YAAY,KACP,oDAAoD,CAC3D,OAASC,cAAc,KAAQ,mBAAmB,CAAC,OAAAC,GAAA,IAAAC,IAAA,CAAAC,IAAA,IAAAC,KAAA,yBAGnD,KAAM,CAAAC,yBAAoE,CAAGC,IAAA,EAIvE,IAJwE,CAC5EC,UAAU,CACVC,OAAO,CACPC,MACF,CAAC,CAAAH,IAAA,CACC,KAAM,CAAEI,GAAG,CAAEC,KAAK,CAAEC,IAAI,CAAEC,KAAM,CAAC,CAAGN,UAAU,CAC9C,KAAM,CAAAO,KAAK,CAAGd,cAAc,CACzBe,KAAgB,EAAKA,KAAK,CAACC,WAAW,CAACC,QAAQ,CAACP,GAAG,CAAC,EAAI,CAC3D,CAAC,CACD,KAAM,CAAAQ,QAAQ,CAAGxB,WAAW,CAAC,CAAC,CAC9B,KAAM,CAAAyB,QAAQ,CAAGxB,WAAW,CAAC,CAAC,CAC9B,KAAM,CAAAyB,GAAG,CAAG3B,MAAM,CAAgB,IAAI,CAAC,CAEvC,KAAM,CAAC,CAAE4B,UAAW,CAAC,CAAEC,OAAO,CAAC,CAAG1B,OAAO,CAAC,CACxC2B,IAAI,CAAE,YAAY,CAClBC,IAAI,CAAEA,CAAA,GAAMjB,UAAU,CACtBkB,GAAG,CAAEA,CAACD,IAAI,CAAEE,OAAO,GAAK,CACtB,KAAM,CAAAC,UAAU,CAAGD,OAAO,CAACE,aAAa,CAAC,CAAC,CAC1C,GAAIJ,IAAI,EAAIG,UAAU,CAAE,CACtBlB,MAAM,CAAC,CAAC,CACV,CACF,CAAC,CACDoB,OAAO,CAAEH,OAAO,GAAK,CACnBL,UAAU,CAAEK,OAAO,CAACL,UAAU,CAAC,CACjC,CAAC,CACH,CAAC,CAAC,CAEF,KAAM,CAAAS,WAAW,CAAGA,CAAA,GAAM,CACxBZ,QAAQ,CAAC,gBAAgBR,GAAG,EAAE,CAAE,CAAEK,KAAK,CAAE,CAAEgB,UAAU,CAAEZ,QAAS,CAAE,CAAC,CAAC,CACtE,CAAC,CAED,KAAM,CAAAa,OAAO,CAAGX,UAAU,CAAG,GAAG,CAAG,CAAC,CAEpC;AACAC,OAAO,CAACF,GAAG,CAAC,CAEZ,mBACEhB,KAAA,OACEgB,GAAG,CAAEA,GAAI,CAETa,SAAS,CAAEpC,MAAM,CAACqC,UAAW,CAC7B1B,OAAO,CAAEsB,WAAY,CACrBK,KAAK,CAAE,CAAEH,OAAQ,CAAE,CACnB,cAAY,iBAAiB,CAAAI,QAAA,eAE7BlC,IAAA,QAAKmC,GAAG,CAAE1B,KAAM,CAAC2B,GAAG,CAAE1B,IAAK,CAACqB,SAAS,CAAEpC,MAAM,CAAC0C,eAAgB,CAAE,CAAC,CAChEzB,KAAK,CAAG,CAAC,eAAIZ,IAAA,CAACJ,OAAO,EAACgB,KAAK,CAAEA,KAAM,CAAC0B,IAAI,CAAC,SAAS,CAACC,UAAU,CAAC,KAAK,CAAE,CAAC,cACvErC,KAAA,QAAK6B,SAAS,CAAEpC,MAAM,CAAC6C,oBAAqB,CAAAN,QAAA,eAC1ClC,IAAA,SAAM+B,SAAS,CAAEpC,MAAM,CAAC8C,eAAgB,CAAAP,QAAA,CAAEvB,KAAK,CAAO,CAAC,cACvDX,IAAA,CAACH,YAAY,EAACwB,IAAI,CAAC,SAAS,CAAE,CAAC,EAC5B,CAAC,cACNrB,IAAA,MAAG+B,SAAS,CAAEpC,MAAM,CAAC+C,cAAe,CAAAR,QAAA,CAAExB,IAAI,CAAI,CAAC,GAZ1CF,GAaH,CAAC,CAET,CAAC,CAQD,cAAe,CAAAL,yBAAyB","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}